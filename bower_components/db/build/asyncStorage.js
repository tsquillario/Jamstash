/*!
(C) Andrea Giammarchi, @WebReflection - Mit Style License
*/
(function(N,M){if(N in M){return}if(typeof __dirname!="undefined"){M.create=j;M=global}else{M[N]={create:j}}function j(X,aa,Z,Y){return new D(X,aa||n,Z||n,Y||1<<20)}function z(){return"".concat.apply("",arguments)}function n(){console.log("[ERROR]",arguments)}var e=j.bind||function(X){var Z=this,Y=[].slice.call(arguments,1);return function(){return Z.apply(X,Y.concat.apply(Y,arguments))}},p=[].indexOf||function(Y){for(var X=this.length;X--&&this[X]!==Y;){}return X},L=M.setTimeout,y="\x00",f="ndexedDB",O="openDatabase",J="executeSql",C="transaction",R="readTransaction",B="localStorage",r="prototype",t=N+"_data",I=N+"_key",g=N+"_value",G="_keys",w="length",h="key",S="getItem",V="setItem",U="removeItem",l="clear",Q=M["i"+f]||M["webkitI"+f]||M["mozI"+f]||M["msI"+f],A=null,u=M.Math.max,D,W,a,s,K,c,T,P,F,x,E,k,m,o,v;if(O in M){D=function D(Y,ac,ab,Z){var X=this;ab=e.call(ab,X);X.name=Y;X.type="WebSQL";try{(X._db=M[O](Y,"1.0","",Z))[C](e.call(a,X,ac,ab),ab)}catch(aa){ab(aa)}};a=function(Z,Y,X){X[J](z("CREATE TABLE IF NOT EXISTS ",t," ","(",g," TEXT NOT NULL,",I," TEXT NOT NULL PRIMARY KEY",")"),[],e.call(s,this,Z,Y),Y)};s=function(Y,X){this._db[R](e.call(K,this,Y,X))};K=function(Z,Y,X){X[J](z("SELECT ",I," AS k FROM ",t),[],e.call(c,this,Z),Y)};c=function(ac,Z,X){for(var aa=this[G]=[],ab=X.rows,Y=ab[w];Y--;aa[Y]=ab.item(Y).k){}ac.call(this,this,this[w]=aa[w])};E=function(X,Y,aa,Z){if(!Z){this[w]=this[G].push(X)}aa.call(this,Y,X,this)};T=function(Y,aa,ac,Z,ab,X){X[J](ab?z("UPDATE ",t," SET ",g," = ? WHERE ",I," = ?"):z("INSERT INTO ",t," VALUES (?, ?)"),[aa,Y],e.call(E,this,Y,aa,ac,ab),Z)};k=function(Z,ab,ac,aa,Y,X){this._db[C](e.call(T,this,Z,ab,ac,aa,!!X.rows.length))};P=function(Y,ab,ac,aa,Z,X){X[J](z("SELECT ",g," AS v FROM ",t," WHERE ",I," = ?"),[Y],e.call(Z,this,Y,ab,ac,aa),aa)};m=function(Z,ac,ad,ab,Y,X){var aa=X.rows;ad.call(this,aa[w]?aa.item(0).v:ac,Z,this)};o=function(Y){var X=this;Y.call(X,X,X[G][w]=X[w]=0)};F=function(Z,Y,X){X[J](z("DELETE FROM ",t),[],e.call(o,this,Z),Y)};v=function(aa,ab,Z,X){if(this[w]=this[w]-u(X.rowsAffected?1:0)){var Y=p.call(this[G],aa);if(~Y){this[G].splice(Y,1)}}else{this[G][w]=0}ab.call(this,aa,this)};x=function(Y,aa,Z,X){X[J](z("DELETE FROM ",t," WHERE ",I," = ?"),[Y],e.call(v,this,Y,aa),Z)};W=D[r];W[h]=function q(X){return this[G][X]};W[U]=function i(X,Z,Y){this._db[C](e.call(x,this,X,Z||n,e.call(Y||n,this)))};W[l]=function H(Y,X){this._db[C](e.call(F,this,Y||n,e.call(X||n,this)))};W[S]=function b(X,Z,Y){this._db[R](e.call(P,this,X,null,Z||n,e.call(Y||n,this),m))};W[V]=function d(X,Z,aa,Y){this._db[R](e.call(P,this,X,Z,aa||n,e.call(Y||n,this),k))}}else{if(Q){D=function D(Z,ac,ab){try{var Y=this,X=Q.open(Y.name=Z,1);Y.type="IndexedDB";X[R]("upgradeneeded",a,!1);X[R](J,e.call(s,Y,ac),!1);X[R](f,e.call(ab,Y),!1)}catch(aa){ab.call(this,aa)}};J="success";f="error";R="addEventListener";a=function(X){X.target.result.createObjectStore(t,{keyPath:I,autoIncrement:!1}).createIndex(g,g,{unique:!1})};s=function(Z,Y){var X=this;X[G]=[];X._db=Y.target.result;m(X).openCursor()[R](J,e.call(K,X,Z),!1)};K=function(aa,Y){var X=this,Z=Y.target.result;if(Z){X[G].push(Z.key);Z["continue"]()}else{aa.call(X,X,c(X))}};c=function(X){return X[w]=X[G][w]};k=function(Y,aa,Z){var X=Z.target.result;aa.call(this,X?X[g]:A,Y,this)};E=function(Z,ab,ac,aa){var X=this,Y=p.call(X[G],Z);~Y||X[G].push(Z);c(X);ac.call(X,ab,Z,X)};m=function(Y,aa){var X=Y._db,Z=X[C];return Z.apply(X,[t].concat(aa?"readwrite":[])).objectStore(t)};v=function(Z,ab,aa){var X=this,Y=p.call(X[G],Z);~Y&&X[G].splice(Y,1);c(X);ab.call(X,Z,X)};o=function(Y){var X=this;Y.call(X,X,X[G][w]=X[w]=0)};W=D[r];W[h]=function q(X){return this[G][X]};W[U]=function i(X,aa,Y){var Z=m(this,1)["delete"](X);Z[R](J,e.call(v,this,X,aa||n),!1);Z[R](f,e.call(Y||n,this),!1)};W[l]=function H(Z,X){var Y=m(this,1).clear();Y[R](J,e.call(o,this,Z||n),!1);Y[R](f,e.call(X||n,this),!1)};W[S]=function b(X,aa,Y){var Z=m(this).get(X);Z[R](J,e.call(k,this,X,aa||n),!1);Z[R](f,e.call(Y||n,this),!1)};W[V]=function d(X,aa,ac,Z){var Y={},ab;Y[I]=X;Y[g]=aa;ab=m(this,1).put(Y);ab[R](J,e.call(E,this,X,aa,ac||n),!1);ab[R](f,e.call(Z||n,this),!1)}}else{if(B in M){D=function D(Y,aa,Z){var X=this;X.name=Y;X.type=B;X._db=M[B];X._prefix=escape(t+y+X.name+y);X[G]=[];c.call(X);L(e.call(aa,X,X,X[w]),0)};c=function(){for(var Z=this,ae=Z._prefix,ad=Z[G],Y=Z._db,X=0,ab=0,ac=Y[w],aa;ab<ac;++ab){if(!(aa=Y[h](ab)||"").indexOf(ae)){ad[X++]=aa}}Z[w]=X};x=function(aa,ad,ac){var Y=this,ab=Y[G],X=Y._prefix+aa,Z=p.call(ab,X);if(~Z){ab.splice(Z,1);Y._db[U](X)}ad.call(Y,aa,Y)};F=function(ac,ab){for(var X=this,aa=X[G],Y=0,Z=aa[w];Y<Z;++Y){X._db[U](aa[Y])}ac.call(X,X,X[w]=X[G][w]=0)};P=function(Y,aa,Z){var X=this;aa.call(X,X._db[S](X._prefix+Y),Y,X)};T=function(Z,ab,ad,aa){var Y=this,X=Y._prefix+Z;try{Y._db[V](X,ab);if(!~p.call(Y[G],X)){Y[w]=Y[G].push(X)}ad.call(Y,ab,Z,Y)}catch(ac){aa.call(Y,ac)}};s=function(X){if(X._db[w]<X[G][w]){throw"unobtrusive attempt to manipulate the localStorage"}return X};W=D[r];W[h]=function q(Y){var X=s(this)[G][Y];return X==A?X:X.slice(this._prefix[w])};W[U]=function i(X,Z,Y){L(e.call(x,s(this),X,Z||n,Y||n),0)};W[l]=function H(Y,X){L(e.call(F,s(this),Y||n,X||n),0)};W[S]=function b(X,Z,Y){L(e.call(P,s(this),X,Z||n,Y||n),0)};W[V]=function d(X,Z,aa,Y){L(e.call(T,s(this),X,Z,aa||n,Y||n),0)}}else{D=function D(Y,aa,Z){var X=this;X.name=Y;X.type="cookie";X._db=M.document;X._prefix=t+y+X.name+y;X[G]=[];c.call(X);L(e.call(aa,X,X,X[w]),0)};c=function(){for(var af=this,ag=af._db.cookie.split(";"),ac=escape(af._prefix),ae=af[G],Z=0,ab=0,X=ag[w],Y,aa,ad;ab<X;++ab){Y=ag[ab];if(!~Y.indexOf(ac)){ae[Z++]=unescape(Y.slice(0,Y.indexOf("=")))}}af[w]=Z};s=function(X){if(X._db.cookie[w]<X[G].join(";")[w]){throw"unobtrusive attempt to manipulate cookies"}return X};x=function(aa,ae,ac){var Y=this,ab=Y[G],ad=Y._prefix+aa,X=escape(ad),Z=Y._db.cookie.indexOf(X);if(~Z){Y._db.cookie=X+"=;expires=Thu, 01-Jan-1970 00:00:01 GMT";Z=p.call(ab,ad);if(~Z){ab.splice(Z,1);Y[w]=ab.length}}ae.call(Y,aa,Y)};F=function(ac,ab){for(var X=this,aa=X._prefix,Z=X[G],Y=Z.length;Y--;x.call(X,Z[Y].slice(aa.length),n,n)){}ac.call(X,X,X[w]=X[G][w]=0)};P=function(aa,ac,Z){var ad=this,ae=ad._db.cookie,Y=escape(ad._prefix+aa),ab=ae.indexOf(Y+"=")+Y[w],af=A,X;if(++ab>Y[w]){X=ae.indexOf(";",ab);X<0&&(X=ae[w]);af=unescape(ae.substr(ab,X-ab))}ac.call(ad,af,aa,ad)};T=function(aa,ad,ae,ac){var Z=this,Y=Z._db.cookie,X=Z._prefix+aa,ab=escape(X);if(!~Y.indexOf(ab)){Z[w]=Z[G].push(X)}Z._db.cookie=z(ab,"=",escape(ad),";","expires=",(new Date(+new Date+365*60*60*24)).toGMTString());ae.call(Z,ad,aa,Z)};W=D[r];W[h]=function q(Y){var X=s(this)[G][Y];return X==A?X:X.slice(this._prefix[w])};W[U]=function i(X,Z,Y){L(e.call(x,s(this),X,Z||n,Y||n),0)};W[l]=function H(Y,X){L(e.call(F,s(this),Y||n,X||n),0)};W[S]=function b(X,Z,Y){L(e.call(P,s(this),X,Z||n,Y||n),0)};W[V]=function d(X,Z,aa,Y){L(e.call(T,s(this),X,Z,aa||n,Y||n),0)}}}}}("asyncStorage",this));